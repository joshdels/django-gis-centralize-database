{% extends "_base.html" %}
{% load i18n %}
{% load account %}
{% load widget_tweaks %}

{% block head_title %}{% trans "Password Reset" %}{% endblock %}

{% block content %}
<div class="min-h-screen flex flex-col items-center justify-center px-4 py-12">
    <div class="w-full max-w-md">
        
        {# --- BRAND HEADER --- #}
        <div class="text-center mb-10">
            <h1 class="text-4xl font-black tracking-tight text-primary">TopMap Solutions</h1>
            <p class="text-sm opacity-60 mt-2 uppercase font-bold tracking-widest text-base-content">Password Recovery</p>
        </div>

        {# --- RESET CARD --- #}
        <div class="card bg-base-100 shadow-2xl border border-base-200 overflow-hidden">
            
            {# Header Section #}
            <div class="bg-base-200/50 py-8 flex flex-col items-center justify-center border-b border-base-200 gap-2">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 text-primary shadow-inner">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z" />
                    </svg>
                </div>
                <h2 class="text-2xl font-black tracking-tight text-center">Recover Access</h2>
            </div>

            <div class="card-body p-8">
                <p class="text-sm font-bold opacity-60 text-center mb-6 leading-relaxed">
                    Enter your registered email to receive a secure re-initialization link.
                </p>

                <form id="reset-request-form" method="post" action="{% url 'account_reset_password' %}" class="space-y-5">
                    {% csrf_token %}

                    {# Email Input Field #}
                    <div class="form-control w-full">
                        <label class="label">
                            <span class="label-text text-[10px] font-black uppercase tracking-widest opacity-50">Email Address</span>
                        </label>
                        <div class="[&_input]:input [&_input]:input-bordered [&_input]:w-full [&_input]:font-medium [&_input]:focus:outline-primary">
                            {{ form.email|add_class:"js-input" }}
                        </div>
                        {% if form.email.errors %}
                            <label class="label js-field-error">
                                <span class="label-text-alt text-error font-bold">{{ form.email.errors.0 }}</span>
                            </label>
                        {% endif %}
                    </div>

                    {# Action Button Section - Increased padding for breathing room #}
                    <div class="pt-6"> 
                        <button type="submit" class="btn btn-primary btn-block text-lg font-black shadow-lg">
                            {% trans "Send Reset Link" %}
                        </button>
                    </div>

                    <div class="divider opacity-10 my-4">OR</div>

                    <div class="text-center">
                        <a href="{% url 'account_login' %}" class="link link-hover text-sm opacity-50 font-black uppercase tracking-widest">
                            Return to Login
                        </a>
                    </div>
                </form>
            </div>
        </div>

        {# Footer #}
        <div class="mt-8">
            {% include "components/footer.html" %}
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('reset-request-form');
        if (form) {
            form.addEventListener('input', (e) => {
                if (e.target.classList.contains('js-input')) {
                    const fieldContainer = e.target.closest('.form-control');
                    const errorLabel = fieldContainer.querySelector('.js-field-error');
                    if (errorLabel) {
                        errorLabel.style.display = 'none';
                    }
                }
            });
        }
    });
</script>
{% endblock %}